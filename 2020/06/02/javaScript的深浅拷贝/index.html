
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>javaScript的深浅拷贝 - 幻尘の屋</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="追求更好的未来，永远阳光,我所理解的JavaScript的深浅拷贝这并不是我第一次解除这个话题，但是这是我第一次深入地对javaScript的深浅拷贝机制进行学习
数据类型我们都知道javaScript拥有很多数据类型我们将,"> 
    <meta name="author" content="幻尘"> 
    <link rel="alternative" href="atom.xml" title="幻尘の屋" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">幻尘の屋</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://www.sleepygod.xyz"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">javaScript的深浅拷贝</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">javaScript的深浅拷贝</h1>
        <div class="stuff">
            <span>六月 02, 2020</span>
            

        </div>
        <div class="content markdown">
            <html><head></head><body><h1 id="我所理解的JavaScript的深浅拷贝"><a href="#我所理解的JavaScript的深浅拷贝" class="headerlink" title="我所理解的JavaScript的深浅拷贝"></a>我所理解的JavaScript的深浅拷贝</h1><p>这并不是我第一次解除这个话题，但是这是我第一次深入地对javaScript的深浅拷贝机制进行学习</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>我们都知道javaScript拥有很多数据类型我们将他们分为两种：</p>
<ul>
<li>基本数据类型</li>
<li>引用数据类型</li>
</ul>
<p>基本数据类型包括： String, Number, Boolean, undefined, null, symbol(<font color="blue">Es6专属</font>) </p>
<p>引用数据类型包括： Object（对象）、Array（数组）、Function（函数）</p>
<p>对于基本数据类型来说，变量直接按值存放在栈内存的简单数据段中，可以直接进行访问，因此并不存在深浅拷贝的区别，</p>
<p>引用类型存放在堆内存中，变量保存的是一个指针，当我们需要访问引用类型的值的时候，首先从栈中获得该对象的地址指针，然后从堆中取得需要的数据</p>
<h2 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h2><p>什么是浅拷贝？</p>
<p>答： 浅拷贝就是只复制了引用，而没有复制真正的值，浅拷贝会使两者指向同一块内存空间</p>
<p>使用<code>=</code>进行浅拷贝是我们做常用的操作</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArray = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> originObj = {<span class="attr">name</span>: <span class="string">'a'</span>, <span class="attr">age</span>: <span class="number">30</span>, <span class="attr">favorite</span>: {<span class="attr">obj</span>: <span class="string">'sing'</span>}};</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cloneArray = originArray; </span><br><span class="line"><span class="keyword">const</span> cloneObj = originObj;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(cloneArray); <span class="comment">// [1,2,3,4]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: 'a', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"></span><br><span class="line">cloneArray.push(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArray); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArray); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"></span><br><span class="line">cloneObj.name = <span class="string">'b'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(originObj); <span class="comment">// {name: 'b', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: 'b', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originObj === cloneObj) <span class="comment">//true</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>以上代码使用了<code>=</code>进行了浅拷贝操作，<code>clone***</code>和<code>origin***</code>指向的是同一块内存空间，因此一个引用的值发生改变时，代表着两个对象的值全都被修改了</p>
<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><p>不同于浅拷贝，深拷贝是对目标的完全拷贝，深拷贝并不只是复制了引用，而是将值也一并复制，使用了新的内存空间，成为新的数据，与旧数据互不影响</p>
<p>常用的深拷贝方法：</p>
<ul>
<li>利用<code>JSON</code>对象的<code>parse</code>和<code>stringify</code></li>
<li>利用递归实现对每一层次的重新创建和赋值</li>
</ul>
<h3 id="JSON-stringify-和JSON-parse-方法"><a href="#JSON-stringify-和JSON-parse-方法" class="headerlink" title="JSON.stringify()和JSON.parse()方法"></a>JSON.stringify()和JSON.parse()方法</h3><p>他们都是做什么的呢？</p>
<blockquote>
<p>The <strong><code>JSON.parse()</code></strong> method parses a JSON string, constructing the JavaScript value or object described by the string. An optional <strong>reviver</strong> function can be provided to perform a transformation on the resulting object before it is returned.</p>
</blockquote>
<p><code>JSON.parse()</code>是将一个<code>JSON</code>字符串转换为<code>Javascript</code>值或对象</p>
<blockquote>
<p>The <strong><code>JSON.stringify()</code></strong> method converts a JavaScript object or value to a JSON string, optionally replacing values if a replacer function is specified or optionally including only the specified properties if a replacer array is specified.</p>
</blockquote>
<p><code>JSON.stringify()</code>是将一个<code>JavaScript</code>值转换为<code>JSON</code>字符串</p>
<p>多说无益直接代码分析：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> originArr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> cloneArr = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(originArr));</span><br><span class="line"></span><br><span class="line">cloneArr.push(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr); <span class="comment">//[ 1, 2, 3, 4, 6 ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>可以看出进行深拷贝之后，原数组的值并没有因为新的数组值改变而改变，十分方便</p>
<p>但是这种方法也是有一定缺点的：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originObj = {</span><br><span class="line">  name:<span class="string">'axuebin'</span>,</span><br><span class="line">  sayHello:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="built_in">console</span>.log(originObj); <span class="comment">// {name: "axuebin", sayHello: ƒ}</span></span><br><span class="line"><span class="keyword">const</span> cloneObj = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(originObj));</span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: "axuebin"}</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>此时发现<code>sayHello</code>并没有被加入到<code>cloneObj</code>中，多方查阅发现<code>MDN</code>有所规定：</p>
<blockquote>
<p>If undefined, a function, or a symbol is encountered during conversion it is either omitted (when it is found in an object) or censored to null (when it is found in an array). JSON.stringify can also just return undefined when passing in “pure” values like JSON.stringify(function(){}) or JSON.stringify(undefined).</p>
</blockquote>
<p>使用上述方法时<code>function</code>、<code>undefined</code>、<code>symbol</code>会被自动忽略，因此当我们的原对象中含有函数时我们不能使用这种方法进行深拷贝</p>
<h3 id="递归方法实现深拷贝"><a href="#递归方法实现深拷贝" class="headerlink" title="递归方法实现深拷贝"></a>递归方法实现深拷贝</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">oldObj</span>) </span>{</span><br><span class="line">  <span class="keyword">const</span> newObj = oldObj.constructor === <span class="built_in">Array</span> ? [] : {};<span class="comment">//判断目标为数组还是对象并</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> oldObj) {</span><br><span class="line">    <span class="keyword">if</span>(oldObj.hasOwnProperty(key)) {</span><br><span class="line">      <span class="keyword">if</span>(oldObj[key] && <span class="keyword">typeof</span> oldObj[key] === <span class="string">'object'</span>) {</span><br><span class="line">        newObj[key] = deepClone(oldObj[key])</span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        newObj[key] = oldObj[key]</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> newObj</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>用以下方法验证一下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oldObj = {</span><br><span class="line">  name: <span class="string">'a'</span>,</span><br><span class="line">  b: {</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    favorite: <span class="string">'coding'</span></span><br><span class="line">  },</span><br><span class="line">  sayHello() {</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello'</span>)</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"><span class="keyword">let</span> newObj = deepClone(oldObj);</span><br><span class="line"></span><br><span class="line">newObj.b.age = <span class="number">19</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(oldObj); <span class="comment">//{ name: 'a', b: { age: 20, favorite: 'coding' }, sayHello: [Function: sayHello] }</span></span><br><span class="line"><span class="built_in">console</span>.log(newObj); <span class="comment">//{ name: 'a', b: { age: 19, favorite: 'coding' }, sayHello: [Function: sayHello] }</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>经过验证这个函数完美实现了深拷贝</p>
<h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h3><p>先来看一下<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noopener">MDN</a>对于这个函数的解释</p>
<blockquote>
<p>The <strong><code>Object.assign()</code></strong> method copies all <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable" target="_blank" rel="noopener">enumerable</a> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty" target="_blank" rel="noopener">own properties</a> from one or more <em>source objects</em> to a <em>target object</em>. It returns the target object.</p>
</blockquote>
<p><code>Object.assgin()</code>方法用于将所有可枚举属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = {</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: { <span class="attr">f</span>: { <span class="attr">g</span>: <span class="number">1</span> } },</span><br><span class="line">  c: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]</span><br><span class="line">};</span><br><span class="line"><span class="keyword">var</span> y = <span class="built_in">Object</span>.assgin({}, x);</span><br><span class="line"><span class="built_in">console</span>.log(y.b.f === x.b.f) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = {</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: { <span class="attr">f</span>: { <span class="attr">g</span>: <span class="number">1</span> } },</span><br><span class="line">  c: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]</span><br><span class="line">};</span><br><span class="line"><span class="keyword">var</span> y = <span class="built_in">Object</span>.assign({}, x);</span><br><span class="line"><span class="built_in">console</span>.log(y.b.f === x.b.f) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">//{ a: 1, b: { f: { g: 1 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"><span class="built_in">console</span>.log(y); <span class="comment">//{ a: 1, b: { f: { g: 1 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"></span><br><span class="line">x.a = <span class="number">2</span>;</span><br><span class="line">x.b.f.g = <span class="number">2</span>；</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">//{ a: 2, b: { f: { g: 2 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"><span class="built_in">console</span>.log(y) <span class="comment">//{ a: 1, b: { f: { g: 2 } }, c: [ 1, 2, 3 ] }</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>由上述代码可知<code>Object.assgin</code>仅仅只是对源对象的第一层进行了深拷贝，而对于内层以及更深层次的对象却只是进行了浅拷贝</p>
<h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h3><blockquote>
<p>The <strong><code>concat()</code></strong> method is used to merge two or more arrays. This method does not change the existing arrays, but instead returns a new array.</p>
</blockquote>
<p> <code>concat()</code> 方法用于合并两个或多个数组。此方法不会更改现有数组，而是返回一个新数组。</p>
<p>开起来是对源数组进行了一次深拷贝，具体状况我们可以试一下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> cloneArr = originArr.concat();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originArr === cloneArr); <span class="comment">//false</span></span><br><span class="line">originArr.push(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr) <span class="comment">// [1,2,3,4]</span></span><br><span class="line"></span><br><span class="line">originArr.push([<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>]);</span><br><span class="line"><span class="keyword">const</span> cloneArr2 = originArr.concat();</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, 6, [ 1, 5, 4 ] ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr2) <span class="comment">// [ 1, 2, 3, 4, 6, [ 1, 5, 4 ] ]</span></span><br><span class="line">originArr[<span class="number">5</span>].push(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, 6, [ 1, 5, 4, 6 ] ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr2) <span class="comment">// [ 1, 2, 3, 4, 6, [ 1, 5, 4, 6 ] ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p><strong>由此可见<code>concat</code>也仅仅只是对源数组的第一层进行了深拷贝</strong></p>
<h3 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h3><blockquote>
<p>The <strong><code>slice()</code></strong> method returns a shallow copy of a portion of an array into a new array object selected from <code>begin</code> to <code>end</code> (<code>end</code> not included) where <code>begin</code> and <code>end</code> represent the index of items in that array. The original array will not be modified.</p>
</blockquote>
<p>在<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice" target="_blank" rel="noopener">MDN</a>的定义中已经明确写了<strong>shallow copy</strong>，但是通过阅读<strong><a href="https://github.com/axuebin" target="_blank" rel="noopener">axuebin</a></strong>博客文章我发现<code>slice</code>方法的确不是完全的浅拷贝</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]];</span><br><span class="line"><span class="keyword">const</span> cloneArr = originArr.slice();</span><br><span class="line"></span><br><span class="line">originArr.push(<span class="number">9</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, [ 5, 6, 7, 8 ], 9 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr); <span class="comment">//[ 1, 2, 3, 4, [ 5, 6, 7, 8 ] ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p><strong>通过实验证明，<code>Array.prototype.slice()</code>的确并非全部浅拷贝，而是对源数组的第一层进行了深拷贝！</strong></p>
<h3 id="问题解析"><a href="#问题解析" class="headerlink" title="问题解析"></a>问题解析</h3><p>为什么会出现只对第一层进行了深拷贝的情况呢？</p>
<p>答：因为在数组或对象中，对内层或跟深层的数组或对象都是存储了一个指针引用，而这些函数在底层实现时都是直接将第一层的数据和引用拷贝下来，因此就形成了只有首层是深拷贝的情况。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>对于 <code>=</code>赋值运算符来说，仅仅是进行了浅拷贝，只是拷贝了对象或数组的引用</li>
<li><code>JSON.stringify()</code>实现了深拷贝，但是会自动省略源对象中的<code>undefined</code>、<code>function</code>、<code>symbol</code></li>
<li>其他js中的函数大多数都只是实现了首层的深拷贝和内层的浅拷贝</li>
<li>递归方法是实现完全深拷贝最简单有效的方法</li>
</ul>
</body></html>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='false'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#我所理解的JavaScript的深浅拷贝"><span class="toc-number">1.</span> <span class="toc-text">我所理解的JavaScript的深浅拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据类型"><span class="toc-number">1.1.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#浅拷贝"><span class="toc-number">1.2.</span> <span class="toc-text">浅拷贝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#深拷贝"><span class="toc-number">1.3.</span> <span class="toc-text">深拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON-stringify-和JSON-parse-方法"><span class="toc-number">1.3.1.</span> <span class="toc-text">JSON.stringify()和JSON.parse()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#递归方法实现深拷贝"><span class="toc-number">1.3.2.</span> <span class="toc-text">递归方法实现深拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-assign"><span class="toc-number">1.3.3.</span> <span class="toc-text">Object.assign()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat"><span class="toc-number">1.3.4.</span> <span class="toc-text">concat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slice"><span class="toc-number">1.3.5.</span> <span class="toc-text">slice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题解析"><span class="toc-number">1.3.6.</span> <span class="toc-text">问题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
