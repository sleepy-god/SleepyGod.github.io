<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>javaScript的深浅拷贝 | 幻尘の屋</title><meta name="description" content="javaScript的深浅拷贝"><meta name="author" content="幻尘"><meta name="copyright" content="幻尘"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="http://ta.qq.com"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="wllVTIXScZteKqkv"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="javaScript的深浅拷贝"><meta name="twitter:description" content="javaScript的深浅拷贝"><meta name="twitter:image" content="https://s1.ax1x.com/2020/06/02/tYnhqI.th.jpg"><meta property="og:type" content="article"><meta property="og:title" content="javaScript的深浅拷贝"><meta property="og:url" content="http://www.sleepygod.xyz/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/"><meta property="og:site_name" content="幻尘の屋"><meta property="og:description" content="javaScript的深浅拷贝"><meta property="og:image" content="https://s1.ax1x.com/2020/06/02/tYnhqI.th.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://www.sleepygod.xyz/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/"><link rel="prev" title="BFC小结" href="http://www.sleepygod.xyz/2020/06/03/BFC%E5%B0%8F%E7%BB%93/"><link rel="next" title="防抖与节流" href="http://www.sleepygod.xyz/2020/06/01/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/"><script src="http://tajs.qq.com/stats?sId=66540395" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://www.sleepygod.xyz/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: 幻尘","link":"链接: http://www.sleepygod.xyz/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/","source":"来源: 幻尘の屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: {"text":"梦想,未来,游戏,前端,二次元,正直,年轻,活力,学渣,志向,坚持,友善","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">幻尘の屋</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">17</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#我所理解的JavaScript的深浅拷贝"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">我所理解的JavaScript的深浅拷贝</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据类型"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">数据类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#浅拷贝"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">浅拷贝</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#深拷贝"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">深拷贝</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#JSON-stringify-和JSON-parse-方法"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">JSON.stringify()和JSON.parse()方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#递归方法实现深拷贝"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">递归方法实现深拷贝</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Object-assign"><span class="toc_mobile_items-number">1.3.3.</span> <span class="toc_mobile_items-text">Object.assign()</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#concat"><span class="toc_mobile_items-number">1.3.4.</span> <span class="toc_mobile_items-text">concat</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#slice"><span class="toc_mobile_items-number">1.3.5.</span> <span class="toc_mobile_items-text">slice</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#问题解析"><span class="toc_mobile_items-number">1.3.6.</span> <span class="toc_mobile_items-text">问题解析</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#总结"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">总结</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#我所理解的JavaScript的深浅拷贝"><span class="toc-number">1.</span> <span class="toc-text">我所理解的JavaScript的深浅拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据类型"><span class="toc-number">1.1.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#浅拷贝"><span class="toc-number">1.2.</span> <span class="toc-text">浅拷贝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#深拷贝"><span class="toc-number">1.3.</span> <span class="toc-text">深拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON-stringify-和JSON-parse-方法"><span class="toc-number">1.3.1.</span> <span class="toc-text">JSON.stringify()和JSON.parse()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#递归方法实现深拷贝"><span class="toc-number">1.3.2.</span> <span class="toc-text">递归方法实现深拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-assign"><span class="toc-number">1.3.3.</span> <span class="toc-text">Object.assign()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat"><span class="toc-number">1.3.4.</span> <span class="toc-text">concat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slice"><span class="toc-number">1.3.5.</span> <span class="toc-text">slice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题解析"><span class="toc-number">1.3.6.</span> <span class="toc-text">问题解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://s1.ax1x.com/2020/06/02/tYnhqI.th.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">javaScript的深浅拷贝</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-06-02<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-06-02</time><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">1.8k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 7 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><html><head></head><body><h1 id="我所理解的JavaScript的深浅拷贝"><a href="#我所理解的JavaScript的深浅拷贝" class="headerlink" title="我所理解的JavaScript的深浅拷贝"></a>我所理解的JavaScript的深浅拷贝</h1><p>这并不是我第一次解除这个话题，但是这是我第一次深入地对javaScript的深浅拷贝机制进行学习</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>我们都知道javaScript拥有很多数据类型我们将他们分为两种：</p>
<ul>
<li>基本数据类型</li>
<li>引用数据类型</li>
</ul>
<p>基本数据类型包括： String, Number, Boolean, undefined, null, symbol(<font color="blue">Es6专属</font>) </p>
<p>引用数据类型包括： Object（对象）、Array（数组）、Function（函数）</p>
<p>对于基本数据类型来说，变量直接按值存放在栈内存的简单数据段中，可以直接进行访问，因此并不存在深浅拷贝的区别，</p>
<p>引用类型存放在堆内存中，变量保存的是一个指针，当我们需要访问引用类型的值的时候，首先从栈中获得该对象的地址指针，然后从堆中取得需要的数据</p>
<h2 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h2><p>什么是浅拷贝？</p>
<p>答： 浅拷贝就是只复制了引用，而没有复制真正的值，浅拷贝会使两者指向同一块内存空间</p>
<p>使用<code>=</code>进行浅拷贝是我们做常用的操作</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArray = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> originObj = {<span class="attr">name</span>: <span class="string">'a'</span>, <span class="attr">age</span>: <span class="number">30</span>, <span class="attr">favorite</span>: {<span class="attr">obj</span>: <span class="string">'sing'</span>}};</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cloneArray = originArray; </span><br><span class="line"><span class="keyword">const</span> cloneObj = originObj;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(cloneArray); <span class="comment">// [1,2,3,4]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: 'a', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"></span><br><span class="line">cloneArray.push(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArray); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArray); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"></span><br><span class="line">cloneObj.name = <span class="string">'b'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(originObj); <span class="comment">// {name: 'b', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: 'b', age: 30, favorite: {obj: 'sing'}}</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originObj === cloneObj) <span class="comment">//true</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>以上代码使用了<code>=</code>进行了浅拷贝操作，<code>clone***</code>和<code>origin***</code>指向的是同一块内存空间，因此一个引用的值发生改变时，代表着两个对象的值全都被修改了</p>
<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><p>不同于浅拷贝，深拷贝是对目标的完全拷贝，深拷贝并不只是复制了引用，而是将值也一并复制，使用了新的内存空间，成为新的数据，与旧数据互不影响</p>
<p>常用的深拷贝方法：</p>
<ul>
<li>利用<code>JSON</code>对象的<code>parse</code>和<code>stringify</code></li>
<li>利用递归实现对每一层次的重新创建和赋值</li>
</ul>
<h3 id="JSON-stringify-和JSON-parse-方法"><a href="#JSON-stringify-和JSON-parse-方法" class="headerlink" title="JSON.stringify()和JSON.parse()方法"></a>JSON.stringify()和JSON.parse()方法</h3><p>他们都是做什么的呢？</p>
<blockquote>
<p>The <strong><code>JSON.parse()</code></strong> method parses a JSON string, constructing the JavaScript value or object described by the string. An optional <strong>reviver</strong> function can be provided to perform a transformation on the resulting object before it is returned.</p>
</blockquote>
<p><code>JSON.parse()</code>是将一个<code>JSON</code>字符串转换为<code>Javascript</code>值或对象</p>
<blockquote>
<p>The <strong><code>JSON.stringify()</code></strong> method converts a JavaScript object or value to a JSON string, optionally replacing values if a replacer function is specified or optionally including only the specified properties if a replacer array is specified.</p>
</blockquote>
<p><code>JSON.stringify()</code>是将一个<code>JavaScript</code>值转换为<code>JSON</code>字符串</p>
<p>多说无益直接代码分析：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> originArr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> cloneArr = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(originArr));</span><br><span class="line"></span><br><span class="line">cloneArr.push(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr); <span class="comment">//[ 1, 2, 3, 4, 6 ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>可以看出进行深拷贝之后，原数组的值并没有因为新的数组值改变而改变，十分方便</p>
<p>但是这种方法也是有一定缺点的：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originObj = {</span><br><span class="line">  name:<span class="string">'axuebin'</span>,</span><br><span class="line">  sayHello:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="built_in">console</span>.log(originObj); <span class="comment">// {name: "axuebin", sayHello: ƒ}</span></span><br><span class="line"><span class="keyword">const</span> cloneObj = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(originObj));</span><br><span class="line"><span class="built_in">console</span>.log(cloneObj); <span class="comment">// {name: "axuebin"}</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>此时发现<code>sayHello</code>并没有被加入到<code>cloneObj</code>中，多方查阅发现<code>MDN</code>有所规定：</p>
<blockquote>
<p>If undefined, a function, or a symbol is encountered during conversion it is either omitted (when it is found in an object) or censored to null (when it is found in an array). JSON.stringify can also just return undefined when passing in “pure” values like JSON.stringify(function(){}) or JSON.stringify(undefined).</p>
</blockquote>
<p>使用上述方法时<code>function</code>、<code>undefined</code>、<code>symbol</code>会被自动忽略，因此当我们的原对象中含有函数时我们不能使用这种方法进行深拷贝</p>
<h3 id="递归方法实现深拷贝"><a href="#递归方法实现深拷贝" class="headerlink" title="递归方法实现深拷贝"></a>递归方法实现深拷贝</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">oldObj</span>) </span>{</span><br><span class="line">  <span class="keyword">const</span> newObj = oldObj.constructor === <span class="built_in">Array</span> ? [] : {};<span class="comment">//判断目标为数组还是对象并</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> oldObj) {</span><br><span class="line">    <span class="keyword">if</span>(oldObj.hasOwnProperty(key)) {</span><br><span class="line">      <span class="keyword">if</span>(oldObj[key] && <span class="keyword">typeof</span> oldObj[key] === <span class="string">'object'</span>) {</span><br><span class="line">        newObj[key] = deepClone(oldObj[key])</span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        newObj[key] = oldObj[key]</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> newObj</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>用以下方法验证一下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oldObj = {</span><br><span class="line">  name: <span class="string">'a'</span>,</span><br><span class="line">  b: {</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    favorite: <span class="string">'coding'</span></span><br><span class="line">  },</span><br><span class="line">  sayHello() {</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello'</span>)</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"><span class="keyword">let</span> newObj = deepClone(oldObj);</span><br><span class="line"></span><br><span class="line">newObj.b.age = <span class="number">19</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(oldObj); <span class="comment">//{ name: 'a', b: { age: 20, favorite: 'coding' }, sayHello: [Function: sayHello] }</span></span><br><span class="line"><span class="built_in">console</span>.log(newObj); <span class="comment">//{ name: 'a', b: { age: 19, favorite: 'coding' }, sayHello: [Function: sayHello] }</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>经过验证这个函数完美实现了深拷贝</p>
<h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h3><p>先来看一下<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noopener">MDN</a>对于这个函数的解释</p>
<blockquote>
<p>The <strong><code>Object.assign()</code></strong> method copies all <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable" target="_blank" rel="noopener">enumerable</a> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty" target="_blank" rel="noopener">own properties</a> from one or more <em>source objects</em> to a <em>target object</em>. It returns the target object.</p>
</blockquote>
<p><code>Object.assgin()</code>方法用于将所有可枚举属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = {</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: { <span class="attr">f</span>: { <span class="attr">g</span>: <span class="number">1</span> } },</span><br><span class="line">  c: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]</span><br><span class="line">};</span><br><span class="line"><span class="keyword">var</span> y = <span class="built_in">Object</span>.assgin({}, x);</span><br><span class="line"><span class="built_in">console</span>.log(y.b.f === x.b.f) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = {</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: { <span class="attr">f</span>: { <span class="attr">g</span>: <span class="number">1</span> } },</span><br><span class="line">  c: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]</span><br><span class="line">};</span><br><span class="line"><span class="keyword">var</span> y = <span class="built_in">Object</span>.assign({}, x);</span><br><span class="line"><span class="built_in">console</span>.log(y.b.f === x.b.f) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">//{ a: 1, b: { f: { g: 1 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"><span class="built_in">console</span>.log(y); <span class="comment">//{ a: 1, b: { f: { g: 1 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"></span><br><span class="line">x.a = <span class="number">2</span>;</span><br><span class="line">x.b.f.g = <span class="number">2</span>；</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">//{ a: 2, b: { f: { g: 2 } }, c: [ 1, 2, 3 ] }</span></span><br><span class="line"><span class="built_in">console</span>.log(y) <span class="comment">//{ a: 1, b: { f: { g: 2 } }, c: [ 1, 2, 3 ] }</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>由上述代码可知<code>Object.assgin</code>仅仅只是对源对象的第一层进行了深拷贝，而对于内层以及更深层次的对象却只是进行了浅拷贝</p>
<h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h3><blockquote>
<p>The <strong><code>concat()</code></strong> method is used to merge two or more arrays. This method does not change the existing arrays, but instead returns a new array.</p>
</blockquote>
<p> <code>concat()</code> 方法用于合并两个或多个数组。此方法不会更改现有数组，而是返回一个新数组。</p>
<p>开起来是对源数组进行了一次深拷贝，具体状况我们可以试一下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> cloneArr = originArr.concat();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(originArr === cloneArr); <span class="comment">//false</span></span><br><span class="line">originArr.push(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">// [1,2,3,4,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr) <span class="comment">// [1,2,3,4]</span></span><br><span class="line"></span><br><span class="line">originArr.push([<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>]);</span><br><span class="line"><span class="keyword">const</span> cloneArr2 = originArr.concat();</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, 6, [ 1, 5, 4 ] ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr2) <span class="comment">// [ 1, 2, 3, 4, 6, [ 1, 5, 4 ] ]</span></span><br><span class="line">originArr[<span class="number">5</span>].push(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, 6, [ 1, 5, 4, 6 ] ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr2) <span class="comment">// [ 1, 2, 3, 4, 6, [ 1, 5, 4, 6 ] ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p><strong>由此可见<code>concat</code>也仅仅只是对源数组的第一层进行了深拷贝</strong></p>
<h3 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h3><blockquote>
<p>The <strong><code>slice()</code></strong> method returns a shallow copy of a portion of an array into a new array object selected from <code>begin</code> to <code>end</code> (<code>end</code> not included) where <code>begin</code> and <code>end</code> represent the index of items in that array. The original array will not be modified.</p>
</blockquote>
<p>在<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice" target="_blank" rel="noopener">MDN</a>的定义中已经明确写了<strong>shallow copy</strong>，但是通过阅读<strong><a href="https://github.com/axuebin" target="_blank" rel="noopener">axuebin</a></strong>博客文章我发现<code>slice</code>方法的确不是完全的浅拷贝</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originArr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]];</span><br><span class="line"><span class="keyword">const</span> cloneArr = originArr.slice();</span><br><span class="line"></span><br><span class="line">originArr.push(<span class="number">9</span>);</span><br><span class="line"><span class="built_in">console</span>.log(originArr); <span class="comment">//[ 1, 2, 3, 4, [ 5, 6, 7, 8 ], 9 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(cloneArr); <span class="comment">//[ 1, 2, 3, 4, [ 5, 6, 7, 8 ] ]</span></span><br></pre></td></tr></tbody></table></figure></div>

<p><strong>通过实验证明，<code>Array.prototype.slice()</code>的确并非全部浅拷贝，而是对源数组的第一层进行了深拷贝！</strong></p>
<h3 id="问题解析"><a href="#问题解析" class="headerlink" title="问题解析"></a>问题解析</h3><p>为什么会出现只对第一层进行了深拷贝的情况呢？</p>
<p>答：因为在数组或对象中，对内层或跟深层的数组或对象都是存储了一个指针引用，而这些函数在底层实现时都是直接将第一层的数据和引用拷贝下来，因此就形成了只有首层是深拷贝的情况。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>对于 <code>=</code>赋值运算符来说，仅仅是进行了浅拷贝，只是拷贝了对象或数组的引用</li>
<li><code>JSON.stringify()</code>实现了深拷贝，但是会自动省略源对象中的<code>undefined</code>、<code>function</code>、<code>symbol</code></li>
<li>其他js中的函数大多数都只是实现了首层的深拷贝和内层的浅拷贝</li>
<li>递归方法是实现完全深拷贝最简单有效的方法</li>
</ul>
</body></html></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">幻尘</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.sleepygod.xyz/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/">http://www.sleepygod.xyz/2020/06/02/javaScript%E7%9A%84%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.sleepygod.xyz">幻尘の屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://s1.ax1x.com/2020/06/02/tYnhqI.th.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/06/03/BFC%E5%B0%8F%E7%BB%93/"><img class="prev_cover lazyload" data-src="https://s1.ax1x.com/2020/06/03/tNxUIA.th.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>BFC小结</span></div></a></div><div class="next-post pull_right"><a href="/2020/06/01/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/"><img class="next_cover lazyload" data-src="https://s1.ax1x.com/2020/06/01/t8iZon.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>防抖与节流</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'OU8A9cTTIRw9H3Ytvx9aOMBU-gzGzoHsz',
  appKey:'EmcdV7J1DhKUOPQmI154lXVe',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://s1.ax1x.com/2020/06/02/tYnhqI.th.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 幻尘</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"><span>蒙ICP备20000691号-1</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/ClickShowText.js"></script></body></html>